<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Workout Sender</title>
  <script src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=0"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    button { margin-right: 10px; padding: 10px 20px; }
  </style>
</head>
<body>
  <h1>Workout Controller</h1>
  <div>
    <button id="link-1">Link TV 1</button>
    <button id="link-2">Link TV 2</button>
    <button id="link-3">Link TV 3</button>
    <button id="link-4">Link TV 4</button>
  </div>
  <div style="margin-top:20px;">
    <button id="start-btn">Start</button>
    <button id="pause-btn">Pause</button>
    <button id="reset-btn">Reset</button>
  </div>

 <script>
  const context = cast.framework.CastReceiverContext.getInstance();
  const channel = 'urn:x-cast:workout.channel';

  const playerManager = context.getPlayerManager();
  const element = document.getElementById('workout-content');
  
  context.addCustomMessageListener(channel, event => {
    const data = event.data;

    if (data.type === 'exercise') {
      element.innerHTML = `
        <h2>${data.payload.name}</h2>
        <div id="timer">Duration: ${data.payload.duration}s</div>
        <div id="progress" style="background:#555;width:100%;height:20px;border-radius:10px;overflow:hidden;">
          <div id="progress-bar" style="height:100%;width:0%;background:#4caf50;"></div>
        </div>
      `;
    }

    if (data.type === 'progress') {
      const bar = document.getElementById('progress-bar');
      if (bar) bar.style.width = `${data.pct}%`;
    }

    if (data.type === 'state' && data.payload === 'stop') {
      element.innerHTML += '<p>Finished!</p>';
    }
  });

  context.start();
</script>

</body>
</html>
