<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Cast Test</title>
  <script>
    window.__onGCastApiAvailable = function(available) {
      if (!available) {
        console.warn('Cast API not available');
        return;
      }
      // initialize CastContext with your new App ID
      cast.framework.CastContext.getInstance().setOptions({
        receiverApplicationId: '0656D6B9',
        autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED
      });
      console.log('CastContext initialized');
    };
  </script>
  <script src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script>
</head>
<body>
  <h1>Chromecast Session Test</h1>
  <button id="castBtn">Link TV</button>

  <script>
    document.getElementById('castBtn').addEventListener('click', () => {
      cast.framework.CastContext.getInstance()
        .requestSession()
        .then(session => {
          console.log('✅ Session established!', session);
          alert('✅ Connected to Chromecast: ' + session.getCastDevice().friendlyName);
        })
        .catch(err => {
          console.error('❌ requestSession failed', err);
          alert('requestSession failed: ' + err.code || err);
        });
    });
  </script>
</body>
</html>
